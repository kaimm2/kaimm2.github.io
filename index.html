
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sev AntiSkid</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      background: #000;
      font-family: 'Poppins', sans-serif;
      overflow-x: hidden;
      position: relative;
    }
    .glass {
      backdrop-filter: blur(18px);
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.15);
    }
    .slide { transition: .4s ease; transform: translateX(-100%); }
    .slide.open { transform: translateX(0); }
    .fadein { animation: fade .7s ease forwards; opacity: 0; }
    @keyframes fade { to { opacity: 1; } }
    .intro-card:hover { transform: translateY(-3px); background: rgba(255,255,255,0.12); }
    #editorModal { backdrop-filter: blur(10px); background: rgba(0,0,0,0.75); }
    .star {
      position: absolute;
      width: 2px;
      height: 2px;
      background: white;
      opacity: 0.8;
      border-radius: 50%;
      animation: fall linear infinite;
    }
    @keyframes fall { 0% { transform: translateY(-10px); opacity: 0.8; } 100% { transform: translateY(110vh); opacity: 0; } }
  </style>
</head>
<body class="text-white">

<!-- Falling stars -->
<div id="stars"></div>

<!-- Top left profile and music -->
<div class="fixed top-4 left-4 z-50 flex items-center space-x-4">
  <img id="profileImg" src="https://i.ibb.co/BK7n4RmF/1a14e47ccd315b5e22132ba41623c806.jpg" alt="Profile" class="w-12 h-12 rounded-full border-2 border-white/20">
  <button id="musicBtn" class="glass p-2 rounded-full hover:bg-white/10">
    <i class="fa fa-music text-xl"></i>
  </button>
</div>

<audio id="bgMusic" loop>
  <source src="https://cdn.discordapp.com/attachments/1441635373615943983/1444552620730744932/internet_money_rich_amiri_keep_it_cool_official_lyric_video_mp3_10837.mp3?ex=692d1ff7&is=692bce77&hm=4430ad7c3ea28fa26a66f718e7fcc435280f3cd4ac9a12279b83fe3ecf0f4495&" type="audio/mpeg">
</audio>

<script>
  // Music toggle
  const musicBtn = document.getElementById('musicBtn');
  const bgMusic = document.getElementById('bgMusic');

  function toggleMusic() {
    if (bgMusic.paused) {
      bgMusic.play().catch(()=>{}); // avoid promise rejection
      musicBtn.innerHTML = '<i class="fa fa-pause text-xl"></i>';
    } else {
      bgMusic.pause();
      musicBtn.innerHTML = '<i class="fa fa-music text-xl"></i>';
    }
  }

  musicBtn.addEventListener('click', toggleMusic);

  // Autoplay on first user interaction
  function playMusicOnce() {
    if (bgMusic.paused) {
      bgMusic.play().catch(()=>{});
      musicBtn.innerHTML = '<i class="fa fa-pause text-xl"></i>';
    }
    document.body.removeEventListener('click', playMusicOnce);
  }
  document.body.addEventListener('click', playMusicOnce, { once: true });

  // Stars background
  const starsContainer = document.getElementById("stars");
  for (let i = 0; i < 150; i++) {
    const star = document.createElement("div");
    star.className = "star";
    star.style.left = Math.random() * window.innerWidth + "px";
    star.style.animationDuration = (Math.random() * 3 + 2) + "s";
    star.style.animationDelay = Math.random() * 5 + "s";
    starsContainer.appendChild(star);
  }
</script>

<!-- Sidebar -->
<div id="sidebar" class="slide fixed top-0 left-0 h-full w-56 glass p-6 pt-14 z-50">
  <h2 class="text-xl font-bold mb-6">Menu</h2>
  <button class="w-full text-left mb-4 p-2 hover:bg-white/10 rounded" onclick="showDashboard()">
    <i class="fa fa-layer-group mr-2"></i> Dashboard
  </button>
  <button class="w-full text-left mb-4 p-2 hover:bg-white/10 rounded" onclick="showStorage()">
    <i class="fa fa-box mr-2"></i> Storage
  </button>
  <button class="w-full text-left mt-6 p-2 hover:bg-white/10 rounded" onclick="logout()">
    <i class="fa fa-right-from-bracket mr-2"></i> Logout
  </button>
</div>

<button onclick="toggleSidebar()" class="fixed top-4 right-4 text-3xl z-50 p-2 glass rounded-xl">
  <i class="fa fa-bars"></i>
</button>

<script>function toggleSidebar() { document.getElementById("sidebar").classList.toggle("open"); }</script>

<!-- Login page -->
<div id="loginPage" class="min-h-screen flex justify-center items-center fadein">
  <div class="glass p-10 rounded-2xl w-96">
    <h1 class="text-3xl font-bold text-center mb-6">Welcome</h1>
    <label class="block font-semibold mb-1">Enter Admin Password:</label>
    <input id="adminPass" class="w-full mb-4 p-3 rounded bg-black/40 border border-white/10" placeholder="Password">
    <button onclick="login()" class="w-full mt-2 glass p-3 rounded-xl hover:bg-white/10">Login</button>
  </div>
</div>

<script>
  function login() {
    let adminPass = document.getElementById("adminPass").value;
    if (adminPass === "xenonsev") {
      sessionStorage.setItem("role", "admin");
      document.getElementById("loginPage").style.display = "none";
      document.getElementById("mainPage").style.display = "block";
      loadFiles();
      return;
    }
    alert("Invalid password");
  }
  function logout() { 
    sessionStorage.clear(); 
    document.getElementById("loginPage").style.display = "flex"; 
    document.getElementById("mainPage").style.display = "none"; 
  }
</script>

<!-- Main page -->
<div id="mainPage" class="hidden p-6 fadein">

  <!-- Dashboard -->
  <div id="dashboard">
    <h2 class="text-3xl font-bold mb-6">Dashboard</h2>
    <div class="glass p-6 rounded-2xl mb-6">
      <h3 class="text-xl font-semibold mb-4">Create Raw File</h3>
      <input id="rawName" class="w-full p-3 mb-3 bg-black/40 rounded border border-white/10" placeholder="Raw file name">
      <textarea id="rawContent" class="w-full p-3 mb-3 bg-black/40 rounded border border-white/10" placeholder="Enter raw content"></textarea>
      <p class="opacity-70 mb-2 text-sm">Or upload file:</p>
      <input type="file" id="rawFile" class="mb-4">
      <button onclick="createRaw()" class="glass p-3 rounded-xl hover:bg-white/10">Create File</button>
    </div>
    <div id="resultBox" class="hidden glass p-6 rounded-xl">
      <h3 class="text-xl font-bold mb-3">Raw Created</h3>
      <p id="resultLink" class="opacity-80 mb-2"></p>
      <p id="resultLoadstring" class="opacity-80 mb-4 text-sm"></p>
      <button onclick="copyResult()" class="glass px-4 py-2 rounded hover:bg-white/10">Copy</button>
    </div>
  </div>

  <!-- Storage -->
  <div id="storage" class="hidden">
    <h2 class="text-3xl font-bold mb-4">Storage</h2>
    <div id="storageList" class="space-y-4"></div>
  </div>

</div>

<!-- Editor Modal -->
<div id="editorModal" class="hidden fixed inset-0 flex items-center justify-center p-6 z-50">
  <div class="glass p-6 rounded-2xl w-full max-w-xl">
    <h2 class="text-2xl font-bold mb-4">Edit File</h2>
    <input id="editName" class="w-full p-3 mb-3 bg-black/40 rounded border border-white/10">
    <textarea id="editContent" class="w-full p-3 h-52 bg-black/40 rounded border border-white/10"></textarea>
    <div class="flex justify-end mt-4">
      <button onclick="closeEditor()" class="mr-4 hover:text-red-300">Cancel</button>
      <button onclick="saveEdit()" class="glass px-4 py-2 rounded hover:bg-white/10">Save</button>
    </div>
  </div>
</div>

<script>
  // Send data to server
  async function sendData(text) {
    const res = await fetch("/upload", { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ text, isText: true }) });
    return res.json();
  }

  // Files storage
  let files = [];
  let editIndex = -1;

  function showDashboard() { document.getElementById("dashboard").style.display = "block"; document.getElementById("storage").style.display = "none"; }
  function showStorage() { document.getElementById("dashboard").style.display = "none"; document.getElementById("storage").style.display = "block"; updateStorage(); }

  // Create raw file
  async function createRaw() {
    let name = rawName.value.trim();
    let content = rawContent.value.trim();
    let file = rawFile.files[0];
    if (!name) return alert("Enter name");
    if (file) content = await file.text();
    if (!content) return alert("Enter content or upload file");

    const response = await sendData(content);
    if (!response || response.error || !response.raw) return alert("Failed to upload");

    let link = response.raw;

    files.push({ name, content, link });
    saveFiles();

    rawName.value = "";
    rawContent.value = "";
    rawFile.value = "";

    document.getElementById("resultBox").classList.remove("hidden");
    resultLink.textContent = "Raw Link: " + link;
    resultLoadstring.textContent = `loadstring(game:HttpGet("${link}"))()`;
    resultBox.scrollIntoView({ behavior: "smooth" });
  }

  function copyResult() {
    let text = resultLink.textContent + "\n" + resultLoadstring.textContent;
    navigator.clipboard.writeText(text);
    alert("Copied!");
  }

  function updateStorage() {
    let box = document.getElementById("storageList");
    box.innerHTML = "";
    files.forEach((f, i) => {
      box.innerHTML += `
        <div class="glass p-4 rounded-xl">
          <h3 class="text-xl font-semibold">${f.name}</h3>
          <p class="text-sm opacity-80 mb-3">${f.link}</p>
          <button onclick="openEditor(${i})" class="mr-3 hover:text-yellow-300">
            <i class="fa fa-pen"></i> Edit
          </button>
          <button onclick="deleteFile(${i})" class="hover:text-red-400">
            <i class="fa fa-trash"></i> Delete
          </button>
        </div>
      `;
    });
  }

  function deleteFile(i) { files.splice(i, 1); saveFiles(); updateStorage(); }
  function openEditor(i) { editIndex = i; editName.value = files[i].name; editContent.value = files[i].content; editorModal.classList.remove("hidden"); }
  function closeEditor() { editorModal.classList.add("hidden"); }
  function saveEdit() { files[editIndex].name = editName.value; files[editIndex].content = editContent.value; saveFiles(); updateStorage(); closeEditor(); }

  function saveFiles() { localStorage.setItem("rawFiles", JSON.stringify(files)); }
  function loadFiles() { 
    const saved = JSON.parse(localStorage.getItem("rawFiles") || "[]");
    files = saved; 
    updateStorage(); 
  }

  if(sessionStorage.getItem("role") === "admin") {
    document.getElementById("loginPage").style.display = "none";
    document.getElementById("mainPage").style.display = "block";
    loadFiles();
  }
</script>

<!-- Introduction -->
<div class="p-10 mt-20">
  <h1 class="text-4xl font-bold text-center mb-10">Production</h1>
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="intro-card glass p-6 rounded-2xl text-center">
      <i class="fa fa-bolt text-4xl mb-4"></i>
      <h2 class="text-xl font-bold mb-2">Fast</h2>
      <p class="opacity-80">Instant raw creation and instant loading speed.</p>
    </div>
    <div class="intro-card glass p-6 rounded-2xl text-center">
      <i class="fa fa-shield-halved text-4xl mb-4"></i>
      <h2 class="text-xl font-bold mb-2">Secure</h2>
      <p class="opacity-80">Your data stays protected with encrypted logic.</p>
    </div>
    <div class="intro-card glass p-6 rounded-2xl text-center">
      <i class="fa fa-gears text-4xl mb-4"></i>
      <h2 class="text-xl font-bold mb-2">How It Works</h2>
      <p class="opacity-80">Create, store, edit, and manage your raw files smoothly.</p>
    </div>
  </div>
</div>

</body>
</html>
